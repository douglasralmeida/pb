machine:
  services:
    - docker

dependencies:
  override:
    - docker info
    - docker build -t douglasralmeida/portalbhsul .

test: 
  override: 
    - docker run -d -p 80:80 douglasralmeida/portalbhsul; sleep 10
    - curl --retry 10 --retry-delay 5 http://127.0.0.1:80/
    - curl --retry 10 --retry-delay 5 -I http://127.0.0.1/js/metro-3.0.17.min.js

deployment:
  hub:
    branch: master
    commands:
      - docker login -e douglasralmeida@live.com -u douglasralmeida -p $DOCKER_PASS
      - docker push douglasralmeida/portalbhsul